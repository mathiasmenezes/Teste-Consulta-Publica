{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Highcastle\\\\Documents\\\\Cidad\\xE3o+ Consulta P\\xFAblica\\\\src\\\\components\\\\auth\\\\OAuthCallback.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useParams, useSearchParams } from 'react-router-dom';\nimport socialAuthService from '../../services/socialAuth';\nimport { CheckCircle, AlertCircle } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst OAuthCallback = () => {\n  _s();\n  const {\n    provider\n  } = useParams();\n  const [searchParams] = useSearchParams();\n  const [status, setStatus] = useState('processing');\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    handleOAuthCallback();\n  }, [provider, searchParams, handleOAuthCallback]);\n  const handleOAuthCallback = useCallback(async () => {\n    try {\n      setStatus('processing');\n\n      // Get parameters from URL\n      const accessToken = searchParams.get('access_token');\n      const errorParam = searchParams.get('error');\n      const errorDescription = searchParams.get('error_description');\n      if (errorParam) {\n        throw new Error(errorDescription || 'OAuth authentication failed');\n      }\n      if (!accessToken) {\n        throw new Error('No access token received');\n      }\n      let result;\n\n      // Process the OAuth callback based on provider\n      switch (provider) {\n        case 'google':\n          result = await socialAuthService.handleGoogleCallback(accessToken);\n          break;\n        case 'facebook':\n          result = await socialAuthService.handleFacebookCallback(accessToken);\n          break;\n        default:\n          throw new Error(`Unsupported provider: ${provider}`);\n      }\n      if (result.success) {\n        // Send success message to parent window\n        window.opener.postMessage({\n          type: 'OAUTH_SUCCESS',\n          payload: result\n        }, window.location.origin);\n        setStatus('success');\n\n        // Close popup after a short delay\n        setTimeout(() => {\n          window.close();\n        }, 2000);\n      } else {\n        throw new Error('Authentication failed');\n      }\n    } catch (error) {\n      console.error('OAuth callback error:', error);\n      setError(error.message);\n      setStatus('error');\n\n      // Send error message to parent window\n      window.opener.postMessage({\n        type: 'OAUTH_ERROR',\n        error: error.message\n      }, window.location.origin);\n\n      // Close popup after a short delay\n      setTimeout(() => {\n        window.close();\n      }, 3000);\n    }\n  }, [provider, searchParams]);\n  if (status === 'processing') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loading-spinner mx-auto mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold text-gray-900 mb-2\",\n          children: [\"Completing \", provider, \" Login...\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Please wait while we complete your authentication.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this);\n  }\n  if (status === 'success') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mx-auto h-16 w-16 bg-green-100 rounded-full flex items-center justify-center mb-4\",\n          children: /*#__PURE__*/_jsxDEV(CheckCircle, {\n            className: \"h-8 w-8 text-green-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold text-gray-900 mb-2\",\n          children: \"Login Successful!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: [\"You have been successfully authenticated with \", provider, \".\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 mt-2\",\n          children: \"This window will close automatically.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this);\n  }\n  if (status === 'error') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mb-4\",\n          children: /*#__PURE__*/_jsxDEV(AlertCircle, {\n            className: \"h-8 w-8 text-red-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold text-gray-900 mb-2\",\n          children: \"Login Failed\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-2\",\n          children: error || 'An error occurred during authentication.'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500\",\n          children: \"This window will close automatically.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this);\n  }\n  return null;\n};\n_s(OAuthCallback, \"hnZ9WXdXFYbj+j8SS1L1Fm7BtJ0=\", false, function () {\n  return [useParams, useSearchParams];\n});\n_c = OAuthCallback;\nexport default OAuthCallback;\nvar _c;\n$RefreshReg$(_c, \"OAuthCallback\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useParams","useSearchParams","socialAuthService","CheckCircle","AlertCircle","jsxDEV","_jsxDEV","OAuthCallback","_s","provider","searchParams","status","setStatus","error","setError","handleOAuthCallback","accessToken","get","errorParam","errorDescription","Error","result","handleGoogleCallback","handleFacebookCallback","success","window","opener","postMessage","type","payload","location","origin","setTimeout","close","console","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Highcastle/Documents/Cidadão+ Consulta Pública/src/components/auth/OAuthCallback.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport { useParams, useSearchParams } from 'react-router-dom';\nimport socialAuthService from '../../services/socialAuth';\nimport { CheckCircle, AlertCircle } from 'lucide-react';\n\nconst OAuthCallback = () => {\n  const { provider } = useParams();\n  const [searchParams] = useSearchParams();\n  const [status, setStatus] = useState('processing');\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    handleOAuthCallback();\n  }, [provider, searchParams, handleOAuthCallback]);\n\n  const handleOAuthCallback = useCallback(async () => {\n    try {\n      setStatus('processing');\n\n      // Get parameters from URL\n      const accessToken = searchParams.get('access_token');\n      const errorParam = searchParams.get('error');\n      const errorDescription = searchParams.get('error_description');\n\n      if (errorParam) {\n        throw new Error(errorDescription || 'OAuth authentication failed');\n      }\n\n      if (!accessToken) {\n        throw new Error('No access token received');\n      }\n\n      let result;\n      \n      // Process the OAuth callback based on provider\n      switch (provider) {\n        case 'google':\n          result = await socialAuthService.handleGoogleCallback(accessToken);\n          break;\n        case 'facebook':\n          result = await socialAuthService.handleFacebookCallback(accessToken);\n          break;\n        default:\n          throw new Error(`Unsupported provider: ${provider}`);\n      }\n\n      if (result.success) {\n        // Send success message to parent window\n        window.opener.postMessage({\n          type: 'OAUTH_SUCCESS',\n          payload: result\n        }, window.location.origin);\n        \n        setStatus('success');\n        \n        // Close popup after a short delay\n        setTimeout(() => {\n          window.close();\n        }, 2000);\n      } else {\n        throw new Error('Authentication failed');\n      }\n    } catch (error) {\n      console.error('OAuth callback error:', error);\n      setError(error.message);\n      setStatus('error');\n      \n      // Send error message to parent window\n      window.opener.postMessage({\n        type: 'OAUTH_ERROR',\n        error: error.message\n      }, window.location.origin);\n      \n      // Close popup after a short delay\n      setTimeout(() => {\n        window.close();\n      }, 3000);\n    }\n  }, [provider, searchParams]);\n\n  if (status === 'processing') {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\">\n        <div className=\"text-center\">\n          <div className=\"loading-spinner mx-auto mb-4\"></div>\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\n            Completing {provider} Login...\n          </h2>\n          <p className=\"text-gray-600\">\n            Please wait while we complete your authentication.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (status === 'success') {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\">\n        <div className=\"text-center\">\n          <div className=\"mx-auto h-16 w-16 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n            <CheckCircle className=\"h-8 w-8 text-green-600\" />\n          </div>\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\n            Login Successful!\n          </h2>\n          <p className=\"text-gray-600\">\n            You have been successfully authenticated with {provider}.\n          </p>\n          <p className=\"text-sm text-gray-500 mt-2\">\n            This window will close automatically.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (status === 'error') {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\">\n        <div className=\"text-center\">\n          <div className=\"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mb-4\">\n            <AlertCircle className=\"h-8 w-8 text-red-600\" />\n          </div>\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\n            Login Failed\n          </h2>\n          <p className=\"text-gray-600 mb-2\">\n            {error || 'An error occurred during authentication.'}\n          </p>\n          <p className=\"text-sm text-gray-500\">\n            This window will close automatically.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return null;\n};\n\nexport default OAuthCallback;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}